function Barss(){}function Auth(){var t=this;t.maskWrapper=$(".mask-wrapper"),t.scrollWrapper=$(".scroll-wrapper"),t.smsBtn=$(".sms-captcha-btn")}Barss.prototype.listenBarHover=function(){var t=$(".auth-box"),n=$(".user-more-box");t.hover(function(){n.show()},function(){n.hide()})},Barss.prototype.runs=function(){this.listenBarHover()},Auth.prototype.showAuthInterface=function(t,n){var e=this;t?(e.maskWrapper.show(),n?e.scrollWrapper.css({left:0}):e.scrollWrapper.css({left:-400})):e.maskWrapper.hide()},Auth.prototype.listenClick=function(){var t=this;$(".signin-btn").click(function(){t.showAuthInterface(!0,!0)}),$(".signup-btn").click(function(){t.showAuthInterface(!0,!1)}),$(".close-btn").click(function(){t.showAuthInterface(!1)}),$(".switch").click(function(){parseInt(t.scrollWrapper.position().left)<0?t.showAuthInterface(!0,!0):t.showAuthInterface(!0,!1)})},Auth.prototype.listenLoginClick=function(){var a=this;console.log("=======listenLoginClick=======");var s=$("#login_tel"),o=$("#login_pwd"),i=$(".check-box");$(".submit-btn").click(function(){var t=s.val(),n=o.val(),e=i.prop("checked");myajax.post({url:"/account/login/",data:{telephone:t,password:n,remember:e?1:0},success:function(t){if(200==t.code)a.showAuthInterface(!1),window.location.reload();else{for(var n in t)t[n];var e=t.message;if("string"==typeof e||e.constructor==String)window.messageBox.show(e);else for(var s in e){var o=e[s][0];window.messageBox.show(o);break}}}})})},Auth.prototype.listenCaptchaClick=function(){var t=$(".img-captcha");t.click(function(){t.attr("src","/account/img_captcha/?random="+Math.random())})},Auth.prototype.smsSuccess=function(){var t=this;messageBox.showSuccess("发送短信验证码成功"),t.smsBtn.addClass("disabled"),t.smsBtn.unbind("click");var n=10,e=setInterval(function(){t.smsBtn.text(n+"s"),--n<0&&(clearInterval(e),t.smsBtn.removeClass("disabled"),t.smsBtn.text("发送验证码"),t.listenSmsClick())},1e3)},Auth.prototype.listenSmsClick=function(){var n=this,e=$('.signup-group input[name="telephone"]');n.smsBtn.click(function(){var t=e.val();t?newajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){200==t.code&&n.smsSuccess()},fail:function(t){console.log(t)}}):messageBox.showInfo("请输入手机号码")})},Auth.prototype.listenSignup=function(){var f=this,m=$(".signup-group");m.find(".submit-btn").click(function(t){t.preventDefault();var n=m.find("input[name='telephone']"),e=m.find("input[name='username']"),s=m.find("input[name='img_captcha']"),o=m.find("input[name='password1']"),a=m.find("input[name='password2']"),i=m.find("input[name='sms_captcha']"),c=n.val(),r=e.val(),u=s.val(),l=o.val(),p=a.val(),h=i.val();myajax.post({url:"/account/register/",data:{telephone:c,username:r,img_captcha:u,password1:l,password2:p,sms_captcha:h},success:function(t){f.showAuthInterface(!1),window.location.reload()}})})},Auth.prototype.run=function(){this.listenClick(),this.listenLoginClick(),this.listenCaptchaClick(),this.listenSmsClick(),this.listenSignup()},$(function(){(new Auth).run(),(new Barss).runs()}),$(function(){window.template&&(template.defaults.imports.timeSince=function(t){var n=new Date(t),e=n.getTime(),s=((new Date).getTime()-e)/1e3;return s<60?"刚刚":60<=s&&s<3600?(minutes=parseInt(s/60),minutes+"分钟前"):3600<=s&&s<86400?(hours=parseInt(s/60/60),hours+"小时前"):86400<=s&&s<2592e3?(days=parseInt(s/60/60/24),days+"天前"):n.getFullYear()+"/"+n.getMonth()+"/"+n.getDay()+" "+n.getHours()+":"+n.getMinutes()})}),console.log("=========");
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImJhc2UvZnJvbnRfYmFzZS5qcyJdLCJuYW1lcyI6WyJCYXJzcyIsIkF1dGgiLCJzZWxmIiwidGhpcyIsIm1hc2tXcmFwcGVyIiwiJCIsInNjcm9sbFdyYXBwZXIiLCJzbXNCdG4iLCJwcm90b3R5cGUiLCJsaXN0ZW5CYXJIb3ZlciIsImF1dGhCb3giLCJib3giLCJob3ZlciIsInNob3ciLCJoaWRlIiwicnVucyIsInNob3dBdXRoSW50ZXJmYWNlIiwibG9naW4iLCJjc3MiLCJsZWZ0IiwibGlzdGVuQ2xpY2siLCJjbGljayIsInBhcnNlSW50IiwicG9zaXRpb24iLCJsaXN0ZW5Mb2dpbkNsaWNrIiwiY29uc29sZSIsImxvZyIsInRlbGVwaG9uZUlucHV0IiwicHdkSW5wdXQiLCJjaGVjayIsInRlbGVwaG9uZSIsInZhbCIsInBhc3N3b3JkIiwicmVtZW1iZXIiLCJwcm9wIiwibXlhamF4IiwicG9zdCIsInVybCIsImRhdGEiLCJzdWNjZXNzIiwicmVzdWx0Iiwid2luZG93IiwibG9jYXRpb24iLCJyZWxvYWQiLCJuYW1lIiwibWVzc2FnZU9iaiIsImNvbnN0cnVjdG9yIiwiU3RyaW5nIiwibWVzc2FnZUJveCIsImtleSIsIm1lc3NhZ2UiLCJsaXN0ZW5DYXB0Y2hhQ2xpY2siLCJjYXB0Y2hhIiwiYXR0ciIsIk1hdGgiLCJyYW5kb20iLCJzbXNTdWNjZXNzIiwic2hvd1N1Y2Nlc3MiLCJhZGRDbGFzcyIsInVuYmluZCIsImNvdW50IiwidGltZXIiLCJzZXRJbnRlcnZhbCIsInRleHQiLCJjbGVhckludGVydmFsIiwicmVtb3ZlQ2xhc3MiLCJsaXN0ZW5TbXNDbGljayIsInRlbElucHV0IiwibmV3YWpheCIsImdldCIsImZhaWwiLCJlcnJvciIsInNob3dJbmZvIiwibGlzdGVuU2lnbnVwIiwic2lnbnVwR3JvdXAiLCJmaW5kIiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInVzZXJuYW1lSW5wdXQiLCJpbWdDYXB0Y2hhSW5wdXQiLCJwYXNzd29yZDFJbnB1dCIsInBhc3N3b3JkMklucHV0Iiwic21zQ2FwdGNoYUlucHV0IiwidXNlcm5hbWUiLCJpbWdfY2FwdGNoYSIsInBhc3N3b3JkMSIsInBhc3N3b3JkMiIsInNtc19jYXB0Y2hhIiwicnVuIiwidGVtcGxhdGUiLCJkZWZhdWx0cyIsImltcG9ydHMiLCJ0aW1lU2luY2UiLCJkYXRlVmFsdWUiLCJkYXRlIiwiRGF0ZSIsImRhdGV0cyIsImdldFRpbWUiLCJ0aW1lc3RhbXAiLCJtaW51dGVzIiwiaG91cnMiLCJkYXlzIiwiZ2V0RnVsbFllYXIiLCJnZXRNb250aCIsImdldERheSIsImdldEhvdXJzIiwiZ2V0TWludXRlcyJdLCJtYXBwaW5ncyI6IkFBQUEsU0FBU0EsU0FvQlQsU0FBU0MsT0FDTCxJQUFJQyxFQUFPQyxLQUNYRCxFQUFLRSxZQUFjQyxFQUFFLGlCQUNyQkgsRUFBS0ksY0FBZ0JELEVBQUUsbUJBQ3ZCSCxFQUFLSyxPQUFTRixFQUFFLG9CQXBCcEJMLE1BQU1RLFVBQVVDLGVBQWlCLFdBQzdCLElBQUlDLEVBQVVMLEVBQUUsYUFDWk0sRUFBTU4sRUFBRSxrQkFDWkssRUFBUUUsTUFBTSxXQUNWRCxFQUFJRSxRQUNMLFdBQ0NGLEVBQUlHLFVBSVpkLE1BQU1RLFVBQVVPLEtBQU8sV0FDUlosS0FDTk0sa0JBV1RSLEtBQUtPLFVBQVVRLGtCQUFvQixTQUFVSCxFQUFNSSxHQUMvQyxJQUFJZixFQUFPQyxLQUNQVSxHQUNBWCxFQUFLRSxZQUFZUyxPQUNiSSxFQUNBZixFQUFLSSxjQUFjWSxJQUFJLENBQUNDLEtBQVEsSUFFaENqQixFQUFLSSxjQUFjWSxJQUFJLENBQUNDLE1BQVMsT0FHckNqQixFQUFLRSxZQUFZVSxRQUl6QmIsS0FBS08sVUFBVVksWUFBYyxXQUN6QixJQUFJbEIsRUFBT0MsS0FFS0UsRUFBRSxlQUNSZ0IsTUFBTSxXQUNabkIsRUFBS2MsbUJBQWtCLEdBQU0sS0FHakJYLEVBQUUsZUFDUmdCLE1BQU0sV0FDWm5CLEVBQUtjLG1CQUFrQixHQUFNLEtBR2xCWCxFQUFFLGNBQ1Jn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d0QsRUFBY0wsRUFBZ0JuRCxNQUVsQ0ksT0FBT0MsS0FBSyxDQUNSQyxJQUFPLHFCQUNQQyxLQUFRLENBQ0pSLFVBQWFBLEVBQ2JxRCxTQUFZQSxFQUNaQyxZQUFlQSxFQUNmQyxVQUFhQSxFQUNiQyxVQUFhQSxFQUNiQyxZQUFlQSxHQUVuQmhELFFBQVcsU0FBVUMsR0FDakJ0QyxFQUFLYyxtQkFBa0IsR0FDdkJ5QixPQUFPQyxTQUFTQyxlQU1oQzFDLEtBQUtPLFVBQVVnRixJQUFNLFdBQ2pCckYsS0FBS2lCLGNBQ0xqQixLQUFLcUIsbUJBQ0xyQixLQUFLZ0QscUJBQ0xoRCxLQUFLK0QsaUJBQ0wvRCxLQUFLc0UsZ0JBR1RwRSxFQUFFLFlBQ2EsSUFBSUosTUFDVnVGLE9BQ0ssSUFBSXhGLE9BQ1ZlLFNBR1JWLEVBQUUsV0FDS29DLE9BQU9nRCxXQUNOQSxTQUFTQyxTQUFTQyxRQUFRQyxVQUFZLFNBQVVDLEdBQzVDLElBQUlDLEVBQU8sSUFBSUMsS0FBS0YsR0FDaEJHLEVBQVNGLEVBQUtHLFVBRWRDLElBRFEsSUFBS0gsTUFBUUUsVUFDQUQsR0FBUSxJQUNqQyxPQUFHRSxFQUFZLEdBQ0osS0FFVSxJQUFiQSxHQUFtQkEsRUFBWSxNQUNuQ0MsUUFBVTdFLFNBQVM0RSxFQUFZLElBQ3hCQyxRQUFRLE9BRUUsTUFBYkQsR0FBc0JBLEVBQVksT0FDdENFLE1BQVE5RSxTQUFTNEUsRUFBWSxHQUFLLElBQzNCRSxNQUFNLE9BRUksT0FBYkYsR0FBeUJBLEVBQVksUUFDekNHLEtBQU8vRSxTQUFTNEUsRUFBWSxHQUFLLEdBQUssSUFDL0JHLEtBQU8sTUFFSFAsRUFBS1EsY0FLSixJQUpBUixFQUFLUyxXQUlLLElBSFpULEVBQUtVLFNBR2UsSUFGbkJWLEVBQUtXLFdBRXVCLElBRDFCWCxFQUFLWSxpQkFTbENqRixRQUFRQyxJQUFJIiwiZmlsZSI6ImJhc2UvZnJvbnRfYmFzZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBCYXJzcygpIHtcbiAgICAvLyB2YXIgc2VsZiA9IHRoaXM7XG59XG5cbkJhcnNzLnByb3RvdHlwZS5saXN0ZW5CYXJIb3ZlciA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgYXV0aEJveCA9ICQoXCIuYXV0aC1ib3hcIik7XG4gICAgdmFyIGJveCA9ICQoJy51c2VyLW1vcmUtYm94Jyk7XG4gICAgYXV0aEJveC5ob3ZlcihmdW5jdGlvbiAoKSB7XG4gICAgICAgIGJveC5zaG93KCk7XG4gICAgfSwgZnVuY3Rpb24gKCkge1xuICAgICAgICBib3guaGlkZSgpO1xuICAgIH0pO1xufTtcblxuQmFyc3MucHJvdG90eXBlLnJ1bnMgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHNlbGYubGlzdGVuQmFySG92ZXIoKTtcbn07XG5cbi8vIC8qIOeZu+mZhumqjOivgeebuOWFsyBzdGFydCAqL1xuZnVuY3Rpb24gQXV0aCgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgc2VsZi5tYXNrV3JhcHBlciA9ICQoJy5tYXNrLXdyYXBwZXInKTtcbiAgICBzZWxmLnNjcm9sbFdyYXBwZXIgPSAkKCcuc2Nyb2xsLXdyYXBwZXInKTtcbiAgICBzZWxmLnNtc0J0biA9ICQoJy5zbXMtY2FwdGNoYS1idG4nKTtcbn1cblxuQXV0aC5wcm90b3R5cGUuc2hvd0F1dGhJbnRlcmZhY2UgPSBmdW5jdGlvbiAoc2hvdywgbG9naW4pIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgaWYgKHNob3cpIHtcbiAgICAgICAgc2VsZi5tYXNrV3JhcHBlci5zaG93KCk7XG4gICAgICAgIGlmIChsb2dpbikge1xuICAgICAgICAgICAgc2VsZi5zY3JvbGxXcmFwcGVyLmNzcyh7XCJsZWZ0XCI6IDB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHNlbGYuc2Nyb2xsV3JhcHBlci5jc3Moe1wibGVmdFwiOiAtNDAwfSk7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBzZWxmLm1hc2tXcmFwcGVyLmhpZGUoKTtcbiAgICB9XG59O1xuXG5BdXRoLnByb3RvdHlwZS5saXN0ZW5DbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG5cbiAgICB2YXIgc2lnbmluQnRuID0gJCgnLnNpZ25pbi1idG4nKTtcbiAgICBzaWduaW5CdG4uY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBzZWxmLnNob3dBdXRoSW50ZXJmYWNlKHRydWUsIHRydWUpO1xuICAgIH0pO1xuXG4gICAgdmFyIHNpZ251cEJ0biA9ICQoJy5zaWdudXAtYnRuJyk7XG4gICAgc2lnbnVwQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgc2VsZi5zaG93QXV0aEludGVyZmFjZSh0cnVlLCBmYWxzZSk7XG4gICAgfSk7XG5cbiAgICB2YXIgY2xvc2VCdG4gPSAkKCcuY2xvc2UtYnRuJyk7XG4gICAgY2xvc2VCdG4uY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBzZWxmLnNob3dBdXRoSW50ZXJmYWNlKGZhbHNlKTtcbiAgICB9KTtcblxuICAgIHZhciBzd2l0Y2hCdG4gPSAkKCcuc3dpdGNoJyk7XG4gICAgc3dpdGNoQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIGxlZnQgPSBwYXJzZUludChzZWxmLnNjcm9sbFdyYXBwZXIucG9zaXRpb24oKS5sZWZ0KTtcbiAgICAgICAgaWYgKGxlZnQgPCAwKSB7IC8vIHNpZ251cFxuICAgICAgICAgICAgc2VsZi5zaG93QXV0aEludGVyZmFjZSh0cnVlLCB0cnVlKTtcbiAgICAgICAgfSBlbHNlIHsgLy8gc2lnbmluXG4gICAgICAgICAgICBzZWxmLnNob3dBdXRoSW50ZXJmYWNlKHRydWUsIGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcblxuQXV0aC5wcm90b3R5cGUubGlzdGVuTG9naW5DbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgY29uc29sZS5sb2coXCI9PT09PT09bGlzdGVuTG9naW5DbGljaz09PT09PT1cIik7XG4gICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gJCgnI2xvZ2luX3RlbCcpO1xuICAgIHZhciBwd2RJbnB1dCA9ICQoJyNsb2dpbl9wd2QnKTtcbiAgICB2YXIgY2hlY2sgPSAkKCcuY2hlY2stYm94Jyk7XG4gICAgLy8gY29uc29sZS5sb2coXCJsaXN0ZW5Mb2dpbkNsaWNrXCIpO1xuICAgIC8vIC8vIHZhciAkc3VibWl0ID0gc2lnbkdyb3VwLmZpbmQoJy5zdWJtaXQtYnRuJyk7XG4gICAgdmFyIHN1Ym1pdCA9ICQoJy5zdWJtaXQtYnRuJyk7XG4gICAgc3VibWl0LmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xuICAgICAgICB2YXIgcGFzc3dvcmQgPSBwd2RJbnB1dC52YWwoKTtcbiAgICAgICAgdmFyIHJlbWVtYmVyID0gY2hlY2sucHJvcChcImNoZWNrZWRcIik7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHRlbGVwaG9uZSk7XG4gICAgICAgIC8vIGNvbnNvbGUubG9nKHBhc3N3b3JkKTtcbiAgICAgICAgLy8gY29uc29sZS5sb2cocmVtZW1iZXIpO1xuXG4gICAgICAgIG15YWpheC5wb3N0KHtcbiAgICAgICAgICAgICd1cmwnOiAnL2FjY291bnQvbG9naW4vJyxcbiAgICAgICAgICAgICdkYXRhJzoge1xuICAgICAgICAgICAgICAgICd0ZWxlcGhvbmUnOiB0ZWxlcGhvbmUsXG4gICAgICAgICAgICAgICAgJ3Bhc3N3b3JkJzogcGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgJ3JlbWVtYmVyJzogcmVtZW1iZXIgPyAxIDogMFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICdzdWNjZXNzJzogZnVuY3Rpb24gKHJlc3VsdCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHRbXCJjb2RlXCJdID09IDIwMCkge1xuICAgICAgICAgICAgICAgICAgICBzZWxmLnNob3dBdXRoSW50ZXJmYWNlKGZhbHNlKTtcbiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciBkZXMgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBuYW1lIGluIHJlc3VsdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVzICs9IG5hbWUgKyBcIjpcIiArIHJlc3VsdFtuYW1lXSArIFwiO1wiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlT2JqID0gcmVzdWx0WydtZXNzYWdlJ107XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgbWVzc2FnZU9iaiA9PSAnc3RyaW5nJyB8fCBtZXNzYWdlT2JqLmNvbnN0cnVjdG9yID09IFN0cmluZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlT2JqKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBtZXNzYWdlT2JqKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1lc3NhZ2VzID0gbWVzc2FnZU9ialtrZXldO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtZXNzYWdlID0gbWVzc2FnZXNbMF07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93Lm1lc3NhZ2VCb3guc2hvdyhtZXNzYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9KTtcbn07XG5cbkF1dGgucHJvdG90eXBlLmxpc3RlbkNhcHRjaGFDbGljayA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgY2FwdGNoYSA9ICQoJy5pbWctY2FwdGNoYScpO1xuICAgIGNhcHRjaGEuY2xpY2soZnVuY3Rpb24gKCkge1xuICAgICAgICBjYXB0Y2hhLmF0dHIoXCJzcmNcIiwgXCIvYWNjb3VudC9pbWdfY2FwdGNoYS9cIiArIFwiP3JhbmRvbT1cIiArIE1hdGgucmFuZG9tKCkpO1xuICAgIH0pO1xufTtcblxuQXV0aC5wcm90b3R5cGUuc21zU3VjY2VzcyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgbWVzc2FnZUJveC5zaG93U3VjY2VzcyhcIuWPkemAgeefreS/oemqjOivgeeggeaIkOWKn1wiKTtcbiAgICBzZWxmLnNtc0J0bi5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICBzZWxmLnNtc0J0bi51bmJpbmQoJ2NsaWNrJyk7XG4gICAgdmFyIGNvdW50ID0gMTA7XG4gICAgdmFyIHRpbWVyID0gc2V0SW50ZXJ2YWwoZnVuY3Rpb24gKCkge1xuICAgICAgICBzZWxmLnNtc0J0bi50ZXh0KGNvdW50ICsgXCJzXCIpO1xuICAgICAgICBjb3VudC0tO1xuICAgICAgICBpZiAoY291bnQgPCAwKSB7XG4gICAgICAgICAgICBjbGVhckludGVydmFsKHRpbWVyKTtcbiAgICAgICAgICAgIHNlbGYuc21zQnRuLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgc2VsZi5zbXNCdG4udGV4dChcIuWPkemAgemqjOivgeeggVwiKTtcbiAgICAgICAgICAgIHNlbGYubGlzdGVuU21zQ2xpY2soKTtcbiAgICAgICAgfVxuICAgIH0sIDEwMDApO1xufTtcblxuQXV0aC5wcm90b3R5cGUubGlzdGVuU21zQ2xpY2sgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHZhciB0ZWxJbnB1dCA9ICQoJy5zaWdudXAtZ3JvdXAgaW5wdXRbbmFtZT1cInRlbGVwaG9uZVwiXScpO1xuICAgIHNlbGYuc21zQnRuLmNsaWNrKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbElucHV0LnZhbCgpO1xuICAgICAgICBpZiAoIXRlbGVwaG9uZSkge1xuICAgICAgICAgICAgbWVzc2FnZUJveC5zaG93SW5mbyhcIuivt+i+k+WFpeaJi+acuuWPt+eggVwiKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBuZXdhamF4LmdldCh7XG4gICAgICAgICAgICBcInVybFwiOiAnL2FjY291bnQvc21zX2NhcHRjaGEvJyxcbiAgICAgICAgICAgIFwiZGF0YVwiOiB7XG4gICAgICAgICAgICAgICAgXCJ0ZWxlcGhvbmVcIjogdGVsZXBob25lXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgXCJzdWNjZXNzXCI6IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBpZiAocmVzdWx0Wydjb2RlJ10gPT0gMjAwKSB7XG4gICAgICAgICAgICAgICAgICAgIHNlbGYuc21zU3VjY2VzcygpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBcImZhaWxcIjogZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9KTtcbn07XG5cbkF1dGgucHJvdG90eXBlLmxpc3RlblNpZ251cCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIHNpZ251cEdyb3VwID0gJCgnLnNpZ251cC1ncm91cCcpO1xuICAgIHZhciBzdWJtaXRCdG4gPSBzaWdudXBHcm91cC5maW5kKCcuc3VibWl0LWJ0bicpO1xuICAgIHN1Ym1pdEJ0bi5jbGljayhmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgdmFyIHRlbGVwaG9uZUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3RlbGVwaG9uZSddXCIpO1xuICAgICAgICB2YXIgdXNlcm5hbWVJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSd1c2VybmFtZSddXCIpO1xuICAgICAgICB2YXIgaW1nQ2FwdGNoYUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J2ltZ19jYXB0Y2hhJ11cIik7XG4gICAgICAgIHZhciBwYXNzd29yZDFJbnB1dCA9IHNpZ251cEdyb3VwLmZpbmQoXCJpbnB1dFtuYW1lPSdwYXNzd29yZDEnXVwiKTtcbiAgICAgICAgdmFyIHBhc3N3b3JkMklucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Bhc3N3b3JkMiddXCIpO1xuICAgICAgICB2YXIgc21zQ2FwdGNoYUlucHV0ID0gc2lnbnVwR3JvdXAuZmluZChcImlucHV0W25hbWU9J3Ntc19jYXB0Y2hhJ11cIik7XG5cbiAgICAgICAgdmFyIHRlbGVwaG9uZSA9IHRlbGVwaG9uZUlucHV0LnZhbCgpO1xuICAgICAgICB2YXIgdXNlcm5hbWUgPSB1c2VybmFtZUlucHV0LnZhbCgpO1xuICAgICAgICB2YXIgaW1nX2NhcHRjaGEgPSBpbWdDYXB0Y2hhSW5wdXQudmFsKCk7XG4gICAgICAgIHZhciBwYXNzd29yZDEgPSBwYXNzd29yZDFJbnB1dC52YWwoKTtcbiAgICAgICAgdmFyIHBhc3N3b3JkMiA9IHBhc3N3b3JkMklucHV0LnZhbCgpO1xuICAgICAgICB2YXIgc21zX2NhcHRjaGEgPSBzbXNDYXB0Y2hhSW5wdXQudmFsKCk7XG5cbiAgICAgICAgbXlhamF4LnBvc3Qoe1xuICAgICAgICAgICAgJ3VybCc6ICcvYWNjb3VudC9yZWdpc3Rlci8nLFxuICAgICAgICAgICAgJ2RhdGEnOiB7XG4gICAgICAgICAgICAgICAgJ3RlbGVwaG9uZSc6IHRlbGVwaG9uZSxcbiAgICAgICAgICAgICAgICAndXNlcm5hbWUnOiB1c2VybmFtZSxcbiAgICAgICAgICAgICAgICAnaW1nX2NhcHRjaGEnOiBpbWdfY2FwdGNoYSxcbiAgICAgICAgICAgICAgICAncGFzc3dvcmQxJzogcGFzc3dvcmQxLFxuICAgICAgICAgICAgICAgICdwYXNzd29yZDInOiBwYXNzd29yZDIsXG4gICAgICAgICAgICAgICAgJ3Ntc19jYXB0Y2hhJzogc21zX2NhcHRjaGFcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAnc3VjY2Vzcyc6IGZ1bmN0aW9uIChyZXN1bHQpIHtcbiAgICAgICAgICAgICAgICBzZWxmLnNob3dBdXRoSW50ZXJmYWNlKGZhbHNlKTtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xufTtcblxuQXV0aC5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMubGlzdGVuQ2xpY2soKTtcbiAgICB0aGlzLmxpc3RlbkxvZ2luQ2xpY2soKTtcbiAgICB0aGlzLmxpc3RlbkNhcHRjaGFDbGljaygpO1xuICAgIHRoaXMubGlzdGVuU21zQ2xpY2soKTtcbiAgICB0aGlzLmxpc3RlblNpZ251cCgpO1xufTtcblxuJChmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGF1dGggPSBuZXcgQXV0aCgpO1xuICAgIGF1dGgucnVuKCk7XG4gICAgdmFyIGJhciA9IG5ldyBCYXJzcygpO1xuICAgIGJhci5ydW5zKCk7XG59KTtcblxuJChmdW5jdGlvbiAoKSB7XG4gICAgaWYod2luZG93LnRlbXBsYXRlKXtcbiAgICAgICAgdGVtcGxhdGUuZGVmYXVsdHMuaW1wb3J0cy50aW1lU2luY2UgPSBmdW5jdGlvbiAoZGF0ZVZhbHVlKSB7XG4gICAgICAgICAgICB2YXIgZGF0ZSA9IG5ldyBEYXRlKGRhdGVWYWx1ZSk7XG4gICAgICAgICAgICB2YXIgZGF0ZXRzID0gZGF0ZS5nZXRUaW1lKCk7IC8vIOW+l+WIsOeahOaYr+avq+enkueahFxuICAgICAgICAgICAgdmFyIG5vd3RzID0gKG5ldyBEYXRlKCkpLmdldFRpbWUoKTsgLy/lvpfliLDnmoTmmK/lvZPliY3ml7bpl7TnmoTml7bpl7TmiLNcbiAgICAgICAgICAgIHZhciB0aW1lc3RhbXAgPSAobm93dHMgLSBkYXRldHMpLzEwMDA7IC8vIOmZpOS7pTEwMDDvvIzlvpfliLDnmoTmmK/np5JcbiAgICAgICAgICAgIGlmKHRpbWVzdGFtcCA8IDYwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICfliJrliJonO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZih0aW1lc3RhbXAgPj0gNjAgJiYgdGltZXN0YW1wIDwgNjAqNjApIHtcbiAgICAgICAgICAgICAgICBtaW51dGVzID0gcGFyc2VJbnQodGltZXN0YW1wIC8gNjApO1xuICAgICAgICAgICAgICAgIHJldHVybiBtaW51dGVzKyfliIbpkp/liY0nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZSBpZih0aW1lc3RhbXAgPj0gNjAqNjAgJiYgdGltZXN0YW1wIDwgNjAqNjAqMjQpIHtcbiAgICAgICAgICAgICAgICBob3VycyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwIC8gNjApO1xuICAgICAgICAgICAgICAgIHJldHVybiBob3Vycysn5bCP5pe25YmNJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYodGltZXN0YW1wID49IDYwKjYwKjI0ICYmIHRpbWVzdGFtcCA8IDYwKjYwKjI0KjMwKSB7XG4gICAgICAgICAgICAgICAgZGF5cyA9IHBhcnNlSW50KHRpbWVzdGFtcCAvIDYwIC8gNjAgLyAyNCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGRheXMgKyAn5aSp5YmNJztcbiAgICAgICAgICAgIH1lbHNle1xuICAgICAgICAgICAgICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xuICAgICAgICAgICAgICAgIHZhciBtb250aCA9IGRhdGUuZ2V0TW9udGgoKTtcbiAgICAgICAgICAgICAgICB2YXIgZGF5ID0gZGF0ZS5nZXREYXkoKTtcbiAgICAgICAgICAgICAgICB2YXIgaG91ciA9IGRhdGUuZ2V0SG91cnMoKTtcbiAgICAgICAgICAgICAgICB2YXIgbWludXRlID0gZGF0ZS5nZXRNaW51dGVzKCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHllYXIrJy8nK21vbnRoKycvJytkYXkrXCIgXCIraG91citcIjpcIittaW51dGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG59KTtcblxuLyog55m76ZmG6aqM6K+B55u45YWzIHN0YXJ0ICovXG5cbmNvbnNvbGUubG9nKFwiPT09PT09PT09XCIpO1xuIl19
